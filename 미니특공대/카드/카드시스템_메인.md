# 카드 시스템

## 개요  
단순 아이템 사용 및 특색없는 볼 스킨 변경밖에 없던 기존의 시스템에서  새로운 유저 경험을 위한 흥미로운 선택지를 제공하기 위해서 캐릭터 카드 시스템을 도입하였습니다. 

카드 리소스로는 기존 시판되었던 미니 특공대 카드 상품의 리소스를 재사용하였으며,  
카드의 효과는 다음과 같이 이루어져 있습니다.  
    1. 아이템 사용효과 강화  
    2. 볼 갯수 증감.  
    3. 특수 블럭 작동방식 변경  
카드화 요소의 목록은 문서 참고 부탁드리겠습니다
> [링크](/리스트/카드화_요소_리스트.md)  

## 목차
1. [카드 효과](#카드-효과)
2. [카드 테이블 및 열거형](#카드-테이블-및-열거형)
3. [카드 효과 구현](#카드-효과-구현)

# 카드 효과

카드 효과 예시입니다.  
기존 게임 분석중 스킬화 가능한 요소들을 분석한 문서입니다
> [링크](리스트/스킬화_가능한_요소_목록.md)

기획단계
```
블록 전체 체력 감소 스킬 관련
    블록 전체 체력 감소 스킬 사용 시 추가로 x% 감소시킵니다.- 블록 전체 체력 감소 스킬 사용 시 x개의 타일이 완전히 파괴됩니다.  

공 50개 추가 스킬 관련
    공 50개 추가 스킬 사용 시 x개의 공을 추가로 제공합니다.- 공 50개 추가 스킬 사용 시 x턴 동안 스킬 효과가 추가 지속됩니다.  

가로(세로) 축 제거 스킬 사용
    스킬 사용 시 추가로 x칸의 가로(세로) 줄을 x% 데미지를 입힙니다.- 스킬 사용 시 추가로 x칸의 가로(세로) 줄을 제거합니다.- 가로축 세로축 스킬에 따른 반대 방향 제거 데미지 및 제거 스킬 추가 부탁  

게임 플레이 시 사용되는 캐릭터 카드 스킬
    게임 시작 시 미사일 아이템 x 개가 자동 발사 됩니다.- 게임 시작 시 맵에 랜덤하게 레이저 아이템이 x 개 생성됩니다.- 게임 시작 시 랜덤한 위치에 폭탄(3x3)이 x개 사용됩니다.- 게임 시작 시 블록 전체 체력을 x% 감소시킵니다.- 게임 시작 시 추가 공을 x개 부여합니다. (무제한 턴)- 게임 시작 시 추가 공을 x턴 동안 x개 부여합니다.- 게임 시작 시 x개의 랜덤 가로(세로)축의 x% 데미지를 입힙니다.

아이템 변경 캐릭터 카드 스킬 (가능하면 개발해주세요)
    모든 레이저 아이템을 x 레이저 아이템으로 변경합니다.- 모든 레이저 아이템을 +레이저 아이템으로 변경합니다.- 모든 폭탄 아이템을 가로(세로)축 폭탄 아이템으로 변경합니다.- 모든 공 추가 아이템을 +3으로 변경합니다.
```

구현 단계
> 카드 테이블 구조 및 열거형 정보 [참고](#카드-테이블-구조-및-열거형-정보)  

카드 효과 타입 추가시 CardEffectType 테이블 데이터 추가 및 CardEffectType Enum에도 추가 및 GameSkillManager 에서 카드 효과 구현 필요.

# 카드 테이블 및 열거형
Card.json // 카드 정보
```json
{
    "index": 1,                             // 테이블 인덱스
    "id": 1,                                // 키드 id
    "name": "Lucy_1Rank",                   // 카드 이름
    "rate": 1,                              // 카드 등급
    "cardType": 1,                          // 카드 타입
    "card_Effect_Slot_0": 5,                // 카드 효과 id 1번
    "card_Effect_Slot_1": 0,                // 카드 효과 id 2번
    "card_Effect_Slot_2": 0,                // 카드 효과 id 3번
    "card_Effect_Slot_3": 0,                // 카드 효과 id 4번
    "resource_img": "CollectionCard_0"      // 카드 리소스 이미지
}
```
CardEffect.json // 카드 효과 정보
```json
{
    "id": 0,                                // 테이블 인덱스
    "cardEffectType": 0,                    // 카드 효과 id
    "description_ID": "None",               // 카드 효과 설명 
    "skill_type": 0,                        // 적용 스킬 타입
    "effectType": 0,                        // 카드 효과 타입
    "Param0Data": null,                     // 파라미터 1
    "Param1Data": null,                     // 파라미터 2
    "Param2Data": null,                     // 파라미터 3
    "Param3Data": null                      // 파라미터 4
}
```

CardEffectType.json
```json
{
    "cardEffectType": 0,                    // 카드 효과 타입 id
    "Param0Type": "System.Int32",           // 파라미터 1 타입
    "Param1Type": "System.Char",            // 파라미터 1 타입
    "Param2Type": "System.String",          // 파라미터 1 타입
    "Param3Type": "System.Boolean"          // 파라미터 1 타입
}
```

CardEffectType 열거형
```c#
public enum CardEffectType
{
    None = 0,
    Range = 10000,
    /// <summary>
    /// 블록 전체 체력 감소 스킬 사용 시 추가로 x% 감소시킵니다. 
    /// </summary>
    Range_Additional_Reduce,
    /// <summary>
    /// 블록 전체 체력 감소 스킬 사용 시 x개의 타일이 완전히 파괴됩니다.
    /// </summary>
    Range_Additional_Remove,
    Range_Start = 11000,
    /// <summary>
    /// 게임 시작 시 블록 전체 체력을 x% 감소시킵니다.
    /// </summary>
    Range_Start_Additional_Reduce,
    AddBall = 20000,
    /// <summary>
    /// 공 추가 스킬 사용 시 x개의 공을 추가로 제공합니다.
    /// </summary>
    AddBall_Extra_Ball,
    /// <summary>
    /// 공 추가 스킬 사용 시 x턴 동안 스킬 효과가 추가 지속됩니다.
    /// </summary>
    AddBall_Extra_Turn,
    AddBall_Start = 21000,
    /// <summary>
    /// 게임 시작 시 추가 공을 x개 부여합니다. (무제한 턴)
    /// </summary>
    AddBall_Start_Extra_Ball_Infi,
    /// <summary>
    /// 게임 시작 시 추가 공을 x턴 동안 x개 부여합니다.
    /// </summary>
    AddBall_Start_Extra_Ball_Turn,
    Exis = 30000,
    /// <summary>
    /// 스킬 사용 시 추가로 x칸의 세로 줄을 x% 데미지를 입힙니다.
    /// </summary>
    Axis_Extra_Reduce_V,
    /// <summary>
    /// 스킬 사용 시 추가로 x칸의 가로 줄을 x% 데미지를 입힙니다.
    /// </summary>
    Axis_Extra_Reduce_H,
    /// <summary>
    /// 스킬 사용 시 추가로 x칸의 세로 줄을 제거합니다.
    /// </summary>
    Axis_Extra_Remove_V,
    /// <summary>
    /// 스킬 사용 시 추가로 x칸의 가로 줄을 제거합니다.
    /// </summary>
    Axis_Extra_Remove_H,
    Axis_Start = 31000,
    /// <summary>
    /// 게임 시작 시 x개의 랜덤 세로 축의 x% 데미지를 입힙니다.
    /// </summary>
    Axis_Start_Rand_Reducer_V,
    /// <summary>
    /// 게임 시작 시 x개의 랜덤 가로 축의 x% 데미지를 입힙니다.
    /// </summary>
    Axis_Start_Rand_Reducer_H,
    /// <summary>
    /// 스킬 사용시 추가로 수직 줄도 제거합니다.
    /// </summary>
    Axis_Extra_Remove_Opposite_V,
    /// <summary>
    /// 스킬 사용시 추가로 수평 줄도 제거합니다.
    /// </summary>
    Axis_Extra_Remove_Opposite_H,
    ItemActive = 40000,
    /// <summary>
    /// 게임 시작 시 미사일 아이템 x 개가 자동 발사 됩니다.
    /// </summary>
    ItemActive_Missile,
    /// <summary>
    /// 게임 시작 시 맵에 랜덤하게 레이저 아이템이 x 개 생성됩니다.
    /// </summary>
    ItemActive_Raser,
    /// <summary>
    /// 게임 시작 시 랜덤한 위치에 폭탄(3x3)이 x개 사용됩니다.
    /// </summary>
    ItemActive_Bomb,
    ItemEdit = 50000,
    /// <summary>
    /// 모든 아이템을 x 레이저 아이템으로 변경합니다.
    /// </summary>
    ItemEdit_Replace_Raser_Cross,
    /// <summary>
    /// 모든 아이템을 + 레이저 아이템으로 변경합니다.
    /// </summary>
    ItemEdit_Replace_Raser_Plus,
    /// <summary>
    /// 모든 아이템을 수직 폭탄  아이템으로 변경합니다.
    /// </summary>
    ItemEdit_Replace_Bomb_V,
    /// <summary>
    /// 모든 아이템을 수평 폭탄 아이템으로 변경합니다.
    /// </summary>
    ItemEdit_Replace_Bomb_H,
    /// <summary>
    /// 모든 아이템을 X폭탄 아이템으로 변경합니다.
    /// </summary>
    ItemEdit_Replace_Bomb_Cross,
    /// <summary>
    /// 모든 아이템을 + 폭탄 아이템으로 변경합니다.
    /// </summary>
    ItemEdit_Replace_Bomb_Plus,
    ItemEdit_AddBall = 50100,
    /// <summary>
    /// 모든 공 추가 아이템을 +1으로 변경합니다.
    /// </summary>
    ItemEdit_AddBall_1,
    /// <summary>
    /// 모든 공 추가 아이템을 +2으로 변경합니다.
    /// </summary>
    ItemEdit_AddBall_2,
    /// <summary>
    /// 모든 공 추가 아이템을 +3으로 변경합니다.
    /// </summary>
    ItemEdit_AddBall_3,
    /// <summary>
    /// 모든 공 추가 아이템을 +4으로 변경합니다.
    /// </summary>
    ItemEdit_AddBall_4,
    /// <summary>
    /// 모든 공 추가 아이템을 +5으로 변경합니다.
    /// </summary>
    ItemEdit_AddBall_5
}
```
*** 

# 카드 효과 구현
카드 효과의 구현은 GameSkillManager 에서 처리되며, 효과 세팅 시퀸스는 다음과 같습니다

1. init  
    1. 현제 세팅된 계수 전체 초기화
    2. 장착중인 카드 정보 로드
    3. 장착중인 카드 정보 에서 타입, 값 추출
    4. 추출한 타입 및 값 계수에 세팅.

스킬 사용시에는 init 단계에서 세팅된 계수에 맞게 효과가 적용됩니다.

자세한 내용은 GameSkillManager 코드 확인 부탁드립니다.

# GameSkillManager

 - -SetDefault()  
    스킬 계수 초기화
 - +Init()  
    카드 정보 로드 후 계수 세팅.
 - +FirstEffect()  
    라운드 시작시 처리
 - +UseSkill(ItemData itemData, bool isFreeItem = false)  
    스킬 사용 처리. 
 - -Skill_Reduce_HP()  
    범위 감소 스킬 처리.
 - -Skill_Remove_Vertical(bool _isAdditional = false)  
    수직 감소 스킬 처리.
 - -Skill_Remove_Horizonal(bool _isAdditional = false)  
    수평 감소 스킬 처리.
 - -Skill_Add_Ball()  
    공 추가 스킬 처리.
